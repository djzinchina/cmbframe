/* File: covarifastmodule.c
 * This file is auto-generated with f2py (version:1.22.4).
 * f2py is a Fortran to Python Interface Generator (FPIG), Second Edition,
 * written by Pearu Peterson <pearu@cens.ioc.ee>.
 * Generation date: Wed Jun 15 15:05:46 2022
 * Do not edit this file directly unless you know what you are doing!!!
 */

#ifdef __cplusplus
extern "C" {
#endif

#ifndef PY_SSIZE_T_CLEAN
#define PY_SSIZE_T_CLEAN
#endif /* PY_SSIZE_T_CLEAN */

/*********************** See f2py2e/cfuncs.py: includes ***********************/
#include <Python.h>
#include <stdarg.h>
#include "fortranobject.h"
#include <math.h>

/**************** See f2py2e/rules.py: mod_rules['modulebody'] ****************/
static PyObject *covarifast_error;
static PyObject *covarifast_module;

/*********************** See f2py2e/cfuncs.py: typedefs ***********************/
#ifdef _WIN32
typedef __int64 long_long;
#else
typedef long long long_long;
typedef unsigned long long unsigned_long_long;
#endif

typedef signed char signed_char;

/****************** See f2py2e/cfuncs.py: typedefs_generated ******************/
/*need_typedefs_generated*/

/********************** See f2py2e/cfuncs.py: cppmacros **********************/
#if defined(PREPEND_FORTRAN)
#if defined(NO_APPEND_FORTRAN)
#if defined(UPPERCASE_FORTRAN)
#define F_FUNC(f,F) _##F
#else
#define F_FUNC(f,F) _##f
#endif
#else
#if defined(UPPERCASE_FORTRAN)
#define F_FUNC(f,F) _##F##_
#else
#define F_FUNC(f,F) _##f##_
#endif
#endif
#else
#if defined(NO_APPEND_FORTRAN)
#if defined(UPPERCASE_FORTRAN)
#define F_FUNC(f,F) F
#else
#define F_FUNC(f,F) f
#endif
#else
#if defined(UPPERCASE_FORTRAN)
#define F_FUNC(f,F) F##_
#else
#define F_FUNC(f,F) f##_
#endif
#endif
#endif
#if defined(UNDERSCORE_G77)
#define F_FUNC_US(f,F) F_FUNC(f##_,F##_)
#else
#define F_FUNC_US(f,F) F_FUNC(f,F)
#endif

#define rank(var) var ## _Rank
#define shape(var,dim) var ## _Dims[dim]
#define old_rank(var) (PyArray_NDIM((PyArrayObject *)(capi_ ## var ## _tmp)))
#define old_shape(var,dim) PyArray_DIM(((PyArrayObject *)(capi_ ## var ## _tmp)),dim)
#define fshape(var,dim) shape(var,rank(var)-dim-1)
#define len(var) shape(var,0)
#define flen(var) fshape(var,0)
#define old_size(var) PyArray_SIZE((PyArrayObject *)(capi_ ## var ## _tmp))
/* #define index(i) capi_i ## i */
#define slen(var) capi_ ## var ## _len
#define size(var, ...) f2py_size((PyArrayObject *)(capi_ ## var ## _tmp), ## __VA_ARGS__, -1)

#define CHECKSCALAR(check,tcheck,name,show,var)\
    if (!(check)) {\
        char errstring[256];\
        sprintf(errstring, "%s: "show, "("tcheck") failed for "name, var);\
        PyErr_SetString(covarifast_error,errstring);\
        /*goto capi_fail;*/\
    } else 
#ifdef DEBUGCFUNCS
#define CFUNCSMESS(mess) fprintf(stderr,"debug-capi:"mess);
#define CFUNCSMESSPY(mess,obj) CFUNCSMESS(mess) \
    PyObject_Print((PyObject *)obj,stderr,Py_PRINT_RAW);\
    fprintf(stderr,"\n");
#else
#define CFUNCSMESS(mess)
#define CFUNCSMESSPY(mess,obj)
#endif

#ifndef max
#define max(a,b) ((a > b) ? (a) : (b))
#endif
#ifndef min
#define min(a,b) ((a < b) ? (a) : (b))
#endif
#ifndef MAX
#define MAX(a,b) ((a > b) ? (a) : (b))
#endif
#ifndef MIN
#define MIN(a,b) ((a < b) ? (a) : (b))
#endif


/************************ See f2py2e/cfuncs.py: cfuncs ************************/
static int f2py_size(PyArrayObject* var, ...)
{
  npy_int sz = 0;
  npy_int dim;
  npy_int rank;
  va_list argp;
  va_start(argp, var);
  dim = va_arg(argp, npy_int);
  if (dim==-1)
    {
      sz = PyArray_SIZE(var);
    }
  else
    {
      rank = PyArray_NDIM(var);
      if (dim>=1 && dim<=rank)
        sz = PyArray_DIM(var, dim-1);
      else
        fprintf(stderr, "f2py_size: 2nd argument value=%d fails to satisfy 1<=value<=%d. Result will be 0.\n", dim, rank);
    }
  va_end(argp);
  return sz;
}

static int
int_from_pyobj(int* v, PyObject *obj, const char *errmess)
{
    PyObject* tmp = NULL;

    if (PyLong_Check(obj)) {
        *v = Npy__PyLong_AsInt(obj);
        return !(*v == -1 && PyErr_Occurred());
    }

    tmp = PyNumber_Long(obj);
    if (tmp) {
        *v = Npy__PyLong_AsInt(tmp);
        Py_DECREF(tmp);
        return !(*v == -1 && PyErr_Occurred());
    }

    if (PyComplex_Check(obj)) {
        PyErr_Clear();
        tmp = PyObject_GetAttrString(obj,"real");
    }
    else if (PyBytes_Check(obj) || PyUnicode_Check(obj)) {
        /*pass*/;
    }
    else if (PySequence_Check(obj)) {
        PyErr_Clear();
        tmp = PySequence_GetItem(obj, 0);
    }

    if (tmp) {
        if (int_from_pyobj(v, tmp, errmess)) {
            Py_DECREF(tmp);
            return 1;
        }
        Py_DECREF(tmp);
    }

    {
        PyObject* err = PyErr_Occurred();
        if (err == NULL) {
            err = covarifast_error;
        }
        PyErr_SetString(err, errmess);
    }
    return 0;
}

static int
long_long_from_pyobj(long_long* v, PyObject *obj, const char *errmess)
{
    PyObject* tmp = NULL;

    if (PyLong_Check(obj)) {
        *v = PyLong_AsLongLong(obj);
        return !(*v == -1 && PyErr_Occurred());
    }

    tmp = PyNumber_Long(obj);
    if (tmp) {
        *v = PyLong_AsLongLong(tmp);
        Py_DECREF(tmp);
        return !(*v == -1 && PyErr_Occurred());
    }

    if (PyComplex_Check(obj)) {
        PyErr_Clear();
        tmp = PyObject_GetAttrString(obj,"real");
    }
    else if (PyBytes_Check(obj) || PyUnicode_Check(obj)) {
        /*pass*/;
    }
    else if (PySequence_Check(obj)) {
        PyErr_Clear();
        tmp = PySequence_GetItem(obj, 0);
    }

    if (tmp) {
        if (long_long_from_pyobj(v, tmp, errmess)) {
            Py_DECREF(tmp);
            return 1;
        }
        Py_DECREF(tmp);
    }
    {
        PyObject* err = PyErr_Occurred();
        if (err == NULL) {
            err = covarifast_error;
        }
        PyErr_SetString(err,errmess);
    }
    return 0;
}


/********************* See f2py2e/cfuncs.py: userincludes *********************/
/*need_userincludes*/

/********************* See f2py2e/capi_rules.py: usercode *********************/


/* See f2py2e/rules.py */
extern void F_FUNC(nbr2idx,NBR2IDX)(int*,int*,long_long*,int*,signed_char*);
extern void F_FUNC(spix2idx,SPIX2IDX)(int*,int*,long_long*,signed_char*);
extern void F_FUNC_US(fast_cov,FAST_COV)(double*,double*,signed_char*,long_long*,double*);
extern void F_FUNC(spmat2npmat,SPMAT2NPMAT)(int*,double*,double*,int*,long_long*,int*);
extern void F_FUNC_US(compute_cov_mat,COMPUTE_COV_MAT)(int*,long_long*,int*,int*,int*,int*,double*,double*);
/*eof externroutines*/

/******************** See f2py2e/capi_rules.py: usercode1 ********************/


/******************* See f2py2e/cb_rules.py: buildcallback *******************/
/*need_callbacks*/

/*********************** See f2py2e/rules.py: buildapi ***********************/

/********************************** nbr2idx **********************************/
static char doc_f2py_rout_covarifast_nbr2idx[] = "\
idx_map_1 = nbr2idx(n2spix_map_1,nbr_grp_1,[npix_1,ngrp_1])\n\nWrapper for ``nbr2idx``.\
\n\nParameters\n----------\n"
"n2spix_map_1 : input rank-1 array('i') with bounds (npix_1)\n"
"nbr_grp_1 : input rank-1 array('i') with bounds (ngrp_1)\n"
"\nOther Parameters\n----------------\n"
"npix_1 : input long, optional\n    Default: shape(n2spix_map_1, 0)\n"
"ngrp_1 : input int, optional\n    Default: shape(nbr_grp_1, 0)\n"
"\nReturns\n-------\n"
"idx_map_1 : rank-1 array('b') with bounds (npix_1)";
/* extern void F_FUNC(nbr2idx,NBR2IDX)(int*,int*,long_long*,int*,signed_char*); */
static PyObject *f2py_rout_covarifast_nbr2idx(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,long_long*,int*,signed_char*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int *n2spix_map_1 = NULL;
    npy_intp n2spix_map_1_Dims[1] = {-1};
    const int n2spix_map_1_Rank = 1;
    PyArrayObject *capi_n2spix_map_1_tmp = NULL;
    int capi_n2spix_map_1_intent = 0;
    PyObject *n2spix_map_1_capi = Py_None;
    int *nbr_grp_1 = NULL;
    npy_intp nbr_grp_1_Dims[1] = {-1};
    const int nbr_grp_1_Rank = 1;
    PyArrayObject *capi_nbr_grp_1_tmp = NULL;
    int capi_nbr_grp_1_intent = 0;
    PyObject *nbr_grp_1_capi = Py_None;
    long_long npix_1 = 0;
    PyObject *npix_1_capi = Py_None;
    int ngrp_1 = 0;
    PyObject *ngrp_1_capi = Py_None;
    signed_char *idx_map_1 = NULL;
    npy_intp idx_map_1_Dims[1] = {-1};
    const int idx_map_1_Rank = 1;
    PyArrayObject *capi_idx_map_1_tmp = NULL;
    int capi_idx_map_1_intent = 0;
    static char *capi_kwlist[] = {"n2spix_map_1","nbr_grp_1","npix_1","ngrp_1",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OO|OO:covarifast.nbr2idx",\
        capi_kwlist,&n2spix_map_1_capi,&nbr_grp_1_capi,&npix_1_capi,&ngrp_1_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable n2spix_map_1 */
    ;
    capi_n2spix_map_1_intent |= F2PY_INTENT_IN;
    capi_n2spix_map_1_tmp = array_from_pyobj(NPY_INT,n2spix_map_1_Dims,n2spix_map_1_Rank,capi_n2spix_map_1_intent,n2spix_map_1_capi);
    if (capi_n2spix_map_1_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : covarifast_error,"failed in converting 1st argument `n2spix_map_1' of covarifast.nbr2idx to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        n2spix_map_1 = (int *)(PyArray_DATA(capi_n2spix_map_1_tmp));

    /* Processing variable nbr_grp_1 */
    ;
    capi_nbr_grp_1_intent |= F2PY_INTENT_IN;
    capi_nbr_grp_1_tmp = array_from_pyobj(NPY_INT,nbr_grp_1_Dims,nbr_grp_1_Rank,capi_nbr_grp_1_intent,nbr_grp_1_capi);
    if (capi_nbr_grp_1_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : covarifast_error,"failed in converting 2nd argument `nbr_grp_1' of covarifast.nbr2idx to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        nbr_grp_1 = (int *)(PyArray_DATA(capi_nbr_grp_1_tmp));

    /* Processing variable ngrp_1 */
    if (ngrp_1_capi == Py_None) ngrp_1 = shape(nbr_grp_1, 0); else
        f2py_success = int_from_pyobj(&ngrp_1,ngrp_1_capi,"covarifast.nbr2idx() 2nd keyword (ngrp_1) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(nbr_grp_1, 0) == ngrp_1,"shape(nbr_grp_1, 0) == ngrp_1","2nd keyword ngrp_1","nbr2idx:ngrp_1=%d",ngrp_1) {
    /* Processing variable npix_1 */
    if (npix_1_capi == Py_None) npix_1 = shape(n2spix_map_1, 0); else
        f2py_success = long_long_from_pyobj(&npix_1,npix_1_capi,"covarifast.nbr2idx() 1st keyword (npix_1) can't be converted to long_long");
    if (f2py_success) {
    CHECKSCALAR(shape(n2spix_map_1, 0) == npix_1,"shape(n2spix_map_1, 0) == npix_1","1st keyword npix_1","nbr2idx:npix_1=%ld",npix_1) {
    /* Processing variable idx_map_1 */
    idx_map_1_Dims[0]=npix_1;
    capi_idx_map_1_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_idx_map_1_tmp = array_from_pyobj(NPY_BYTE,idx_map_1_Dims,idx_map_1_Rank,capi_idx_map_1_intent,Py_None);
    if (capi_idx_map_1_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : covarifast_error,"failed in converting hidden `idx_map_1' of covarifast.nbr2idx to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        idx_map_1 = (signed_char *)(PyArray_DATA(capi_idx_map_1_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(n2spix_map_1,nbr_grp_1,&npix_1,&ngrp_1,idx_map_1);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_idx_map_1_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /*if (capi_idx_map_1_tmp == NULL) ... else of idx_map_1*/
    /* End of cleaning variable idx_map_1 */
    } /*CHECKSCALAR(shape(n2spix_map_1, 0) == npix_1)*/
    } /*if (f2py_success) of npix_1*/
    /* End of cleaning variable npix_1 */
    } /*CHECKSCALAR(shape(nbr_grp_1, 0) == ngrp_1)*/
    } /*if (f2py_success) of ngrp_1*/
    /* End of cleaning variable ngrp_1 */
    if((PyObject *)capi_nbr_grp_1_tmp!=nbr_grp_1_capi) {
        Py_XDECREF(capi_nbr_grp_1_tmp); }
    }  /*if (capi_nbr_grp_1_tmp == NULL) ... else of nbr_grp_1*/
    /* End of cleaning variable nbr_grp_1 */
    if((PyObject *)capi_n2spix_map_1_tmp!=n2spix_map_1_capi) {
        Py_XDECREF(capi_n2spix_map_1_tmp); }
    }  /*if (capi_n2spix_map_1_tmp == NULL) ... else of n2spix_map_1*/
    /* End of cleaning variable n2spix_map_1 */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/******************************* end of nbr2idx *******************************/

/********************************** spix2idx **********************************/
static char doc_f2py_rout_covarifast_spix2idx[] = "\
idx_map_2 = spix2idx(n2spix_map_2,spix_2,[npix_2])\n\nWrapper for ``spix2idx``.\
\n\nParameters\n----------\n"
"n2spix_map_2 : input rank-1 array('i') with bounds (npix_2)\n"
"spix_2 : input int\n"
"\nOther Parameters\n----------------\n"
"npix_2 : input long, optional\n    Default: shape(n2spix_map_2, 0)\n"
"\nReturns\n-------\n"
"idx_map_2 : rank-1 array('b') with bounds (npix_2)";
/* extern void F_FUNC(spix2idx,SPIX2IDX)(int*,int*,long_long*,signed_char*); */
static PyObject *f2py_rout_covarifast_spix2idx(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,long_long*,signed_char*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int *n2spix_map_2 = NULL;
    npy_intp n2spix_map_2_Dims[1] = {-1};
    const int n2spix_map_2_Rank = 1;
    PyArrayObject *capi_n2spix_map_2_tmp = NULL;
    int capi_n2spix_map_2_intent = 0;
    PyObject *n2spix_map_2_capi = Py_None;
    int spix_2 = 0;
    PyObject *spix_2_capi = Py_None;
    long_long npix_2 = 0;
    PyObject *npix_2_capi = Py_None;
    signed_char *idx_map_2 = NULL;
    npy_intp idx_map_2_Dims[1] = {-1};
    const int idx_map_2_Rank = 1;
    PyArrayObject *capi_idx_map_2_tmp = NULL;
    int capi_idx_map_2_intent = 0;
    static char *capi_kwlist[] = {"n2spix_map_2","spix_2","npix_2",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OO|O:covarifast.spix2idx",\
        capi_kwlist,&n2spix_map_2_capi,&spix_2_capi,&npix_2_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable spix_2 */
        f2py_success = int_from_pyobj(&spix_2,spix_2_capi,"covarifast.spix2idx() 2nd argument (spix_2) can't be converted to int");
    if (f2py_success) {
    /* Processing variable n2spix_map_2 */
    ;
    capi_n2spix_map_2_intent |= F2PY_INTENT_IN;
    capi_n2spix_map_2_tmp = array_from_pyobj(NPY_INT,n2spix_map_2_Dims,n2spix_map_2_Rank,capi_n2spix_map_2_intent,n2spix_map_2_capi);
    if (capi_n2spix_map_2_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : covarifast_error,"failed in converting 1st argument `n2spix_map_2' of covarifast.spix2idx to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        n2spix_map_2 = (int *)(PyArray_DATA(capi_n2spix_map_2_tmp));

    /* Processing variable npix_2 */
    if (npix_2_capi == Py_None) npix_2 = shape(n2spix_map_2, 0); else
        f2py_success = long_long_from_pyobj(&npix_2,npix_2_capi,"covarifast.spix2idx() 1st keyword (npix_2) can't be converted to long_long");
    if (f2py_success) {
    CHECKSCALAR(shape(n2spix_map_2, 0) == npix_2,"shape(n2spix_map_2, 0) == npix_2","1st keyword npix_2","spix2idx:npix_2=%ld",npix_2) {
    /* Processing variable idx_map_2 */
    idx_map_2_Dims[0]=npix_2;
    capi_idx_map_2_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_idx_map_2_tmp = array_from_pyobj(NPY_BYTE,idx_map_2_Dims,idx_map_2_Rank,capi_idx_map_2_intent,Py_None);
    if (capi_idx_map_2_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : covarifast_error,"failed in converting hidden `idx_map_2' of covarifast.spix2idx to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        idx_map_2 = (signed_char *)(PyArray_DATA(capi_idx_map_2_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(n2spix_map_2,&spix_2,&npix_2,idx_map_2);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_idx_map_2_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /*if (capi_idx_map_2_tmp == NULL) ... else of idx_map_2*/
    /* End of cleaning variable idx_map_2 */
    } /*CHECKSCALAR(shape(n2spix_map_2, 0) == npix_2)*/
    } /*if (f2py_success) of npix_2*/
    /* End of cleaning variable npix_2 */
    if((PyObject *)capi_n2spix_map_2_tmp!=n2spix_map_2_capi) {
        Py_XDECREF(capi_n2spix_map_2_tmp); }
    }  /*if (capi_n2spix_map_2_tmp == NULL) ... else of n2spix_map_2*/
    /* End of cleaning variable n2spix_map_2 */
    } /*if (f2py_success) of spix_2*/
    /* End of cleaning variable spix_2 */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/****************************** end of spix2idx ******************************/

/********************************** fast_cov **********************************/
static char doc_f2py_rout_covarifast_fast_cov[] = "\
cov = fast_cov(map_1,map_2,mask,[npix_3])\n\nWrapper for ``fast_cov``.\
\n\nParameters\n----------\n"
"map_1 : input rank-1 array('d') with bounds (npix_3)\n"
"map_2 : input rank-1 array('d') with bounds (npix_3)\n"
"mask : input rank-1 array('b') with bounds (npix_3)\n"
"\nOther Parameters\n----------------\n"
"npix_3 : input long, optional\n    Default: shape(map_1, 0)\n"
"\nReturns\n-------\n"
"cov : float";
/* extern void F_FUNC_US(fast_cov,FAST_COV)(double*,double*,signed_char*,long_long*,double*); */
static PyObject *f2py_rout_covarifast_fast_cov(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,signed_char*,long_long*,double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *map_1 = NULL;
    npy_intp map_1_Dims[1] = {-1};
    const int map_1_Rank = 1;
    PyArrayObject *capi_map_1_tmp = NULL;
    int capi_map_1_intent = 0;
    PyObject *map_1_capi = Py_None;
    double *map_2 = NULL;
    npy_intp map_2_Dims[1] = {-1};
    const int map_2_Rank = 1;
    PyArrayObject *capi_map_2_tmp = NULL;
    int capi_map_2_intent = 0;
    PyObject *map_2_capi = Py_None;
    signed_char *mask = NULL;
    npy_intp mask_Dims[1] = {-1};
    const int mask_Rank = 1;
    PyArrayObject *capi_mask_tmp = NULL;
    int capi_mask_intent = 0;
    PyObject *mask_capi = Py_None;
    long_long npix_3 = 0;
    PyObject *npix_3_capi = Py_None;
    double cov = 0;
    static char *capi_kwlist[] = {"map_1","map_2","mask","npix_3",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOO|O:covarifast.fast_cov",\
        capi_kwlist,&map_1_capi,&map_2_capi,&mask_capi,&npix_3_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable map_1 */
    ;
    capi_map_1_intent |= F2PY_INTENT_IN;
    capi_map_1_tmp = array_from_pyobj(NPY_DOUBLE,map_1_Dims,map_1_Rank,capi_map_1_intent,map_1_capi);
    if (capi_map_1_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : covarifast_error,"failed in converting 1st argument `map_1' of covarifast.fast_cov to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        map_1 = (double *)(PyArray_DATA(capi_map_1_tmp));

    /* Processing variable cov */
    /* Processing variable npix_3 */
    if (npix_3_capi == Py_None) npix_3 = shape(map_1, 0); else
        f2py_success = long_long_from_pyobj(&npix_3,npix_3_capi,"covarifast.fast_cov() 1st keyword (npix_3) can't be converted to long_long");
    if (f2py_success) {
    CHECKSCALAR(shape(map_1, 0) == npix_3,"shape(map_1, 0) == npix_3","1st keyword npix_3","fast_cov:npix_3=%ld",npix_3) {
    /* Processing variable map_2 */
    map_2_Dims[0]=npix_3;
    capi_map_2_intent |= F2PY_INTENT_IN;
    capi_map_2_tmp = array_from_pyobj(NPY_DOUBLE,map_2_Dims,map_2_Rank,capi_map_2_intent,map_2_capi);
    if (capi_map_2_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : covarifast_error,"failed in converting 2nd argument `map_2' of covarifast.fast_cov to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        map_2 = (double *)(PyArray_DATA(capi_map_2_tmp));

    /* Processing variable mask */
    mask_Dims[0]=npix_3;
    capi_mask_intent |= F2PY_INTENT_IN;
    capi_mask_tmp = array_from_pyobj(NPY_BYTE,mask_Dims,mask_Rank,capi_mask_intent,mask_capi);
    if (capi_mask_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : covarifast_error,"failed in converting 3rd argument `mask' of covarifast.fast_cov to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        mask = (signed_char *)(PyArray_DATA(capi_mask_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(map_1,map_2,mask,&npix_3,&cov);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("d",cov);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    if((PyObject *)capi_mask_tmp!=mask_capi) {
        Py_XDECREF(capi_mask_tmp); }
    }  /*if (capi_mask_tmp == NULL) ... else of mask*/
    /* End of cleaning variable mask */
    if((PyObject *)capi_map_2_tmp!=map_2_capi) {
        Py_XDECREF(capi_map_2_tmp); }
    }  /*if (capi_map_2_tmp == NULL) ... else of map_2*/
    /* End of cleaning variable map_2 */
    } /*CHECKSCALAR(shape(map_1, 0) == npix_3)*/
    } /*if (f2py_success) of npix_3*/
    /* End of cleaning variable npix_3 */
    /* End of cleaning variable cov */
    if((PyObject *)capi_map_1_tmp!=map_1_capi) {
        Py_XDECREF(capi_map_1_tmp); }
    }  /*if (capi_map_1_tmp == NULL) ... else of map_1*/
    /* End of cleaning variable map_1 */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/****************************** end of fast_cov ******************************/

/******************************** spmat2npmat ********************************/
static char doc_f2py_rout_covarifast_spmat2npmat[] = "\
npix_mat = spmat2npmat(s2npix_map,spix_mat,[npix_sup,npix_map,nu_dim])\n\nWrapper for ``spmat2npmat``.\
\n\nParameters\n----------\n"
"s2npix_map : input rank-1 array('i') with bounds (npix_map)\n"
"spix_mat : input rank-3 array('d') with bounds (npix_sup,nu_dim,nu_dim)\n"
"\nOther Parameters\n----------------\n"
"npix_sup : input int, optional\n    Default: shape(spix_mat, 0)\n"
"npix_map : input long, optional\n    Default: shape(s2npix_map, 0)\n"
"nu_dim : input int, optional\n    Default: shape(spix_mat, 1)\n"
"\nReturns\n-------\n"
"npix_mat : rank-3 array('d') with bounds (npix_map,nu_dim,nu_dim)";
/* extern void F_FUNC(spmat2npmat,SPMAT2NPMAT)(int*,double*,double*,int*,long_long*,int*); */
static PyObject *f2py_rout_covarifast_spmat2npmat(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,double*,double*,int*,long_long*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int *s2npix_map = NULL;
    npy_intp s2npix_map_Dims[1] = {-1};
    const int s2npix_map_Rank = 1;
    PyArrayObject *capi_s2npix_map_tmp = NULL;
    int capi_s2npix_map_intent = 0;
    PyObject *s2npix_map_capi = Py_None;
    double *spix_mat = NULL;
    npy_intp spix_mat_Dims[3] = {-1, -1, -1};
    const int spix_mat_Rank = 3;
    PyArrayObject *capi_spix_mat_tmp = NULL;
    int capi_spix_mat_intent = 0;
    PyObject *spix_mat_capi = Py_None;
    double *npix_mat = NULL;
    npy_intp npix_mat_Dims[3] = {-1, -1, -1};
    const int npix_mat_Rank = 3;
    PyArrayObject *capi_npix_mat_tmp = NULL;
    int capi_npix_mat_intent = 0;
    int npix_sup = 0;
    PyObject *npix_sup_capi = Py_None;
    long_long npix_map = 0;
    PyObject *npix_map_capi = Py_None;
    int nu_dim = 0;
    PyObject *nu_dim_capi = Py_None;
    static char *capi_kwlist[] = {"s2npix_map","spix_mat","npix_sup","npix_map","nu_dim",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OO|OOO:covarifast.spmat2npmat",\
        capi_kwlist,&s2npix_map_capi,&spix_mat_capi,&npix_sup_capi,&npix_map_capi,&nu_dim_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable s2npix_map */
    ;
    capi_s2npix_map_intent |= F2PY_INTENT_IN;
    capi_s2npix_map_tmp = array_from_pyobj(NPY_INT,s2npix_map_Dims,s2npix_map_Rank,capi_s2npix_map_intent,s2npix_map_capi);
    if (capi_s2npix_map_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : covarifast_error,"failed in converting 1st argument `s2npix_map' of covarifast.spmat2npmat to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        s2npix_map = (int *)(PyArray_DATA(capi_s2npix_map_tmp));

    /* Processing variable spix_mat */
    ;
    capi_spix_mat_intent |= F2PY_INTENT_IN;
    capi_spix_mat_tmp = array_from_pyobj(NPY_DOUBLE,spix_mat_Dims,spix_mat_Rank,capi_spix_mat_intent,spix_mat_capi);
    if (capi_spix_mat_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : covarifast_error,"failed in converting 2nd argument `spix_mat' of covarifast.spmat2npmat to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        spix_mat = (double *)(PyArray_DATA(capi_spix_mat_tmp));

    /* Processing variable npix_sup */
    if (npix_sup_capi == Py_None) npix_sup = shape(spix_mat, 0); else
        f2py_success = int_from_pyobj(&npix_sup,npix_sup_capi,"covarifast.spmat2npmat() 1st keyword (npix_sup) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(spix_mat, 0) == npix_sup,"shape(spix_mat, 0) == npix_sup","1st keyword npix_sup","spmat2npmat:npix_sup=%d",npix_sup) {
    /* Processing variable nu_dim */
    if (nu_dim_capi == Py_None) nu_dim = shape(spix_mat, 1); else
        f2py_success = int_from_pyobj(&nu_dim,nu_dim_capi,"covarifast.spmat2npmat() 3rd keyword (nu_dim) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(spix_mat, 1) == nu_dim,"shape(spix_mat, 1) == nu_dim","3rd keyword nu_dim","spmat2npmat:nu_dim=%d",nu_dim) {
    /* Processing variable npix_map */
    if (npix_map_capi == Py_None) npix_map = shape(s2npix_map, 0); else
        f2py_success = long_long_from_pyobj(&npix_map,npix_map_capi,"covarifast.spmat2npmat() 2nd keyword (npix_map) can't be converted to long_long");
    if (f2py_success) {
    CHECKSCALAR(shape(s2npix_map, 0) == npix_map,"shape(s2npix_map, 0) == npix_map","2nd keyword npix_map","spmat2npmat:npix_map=%ld",npix_map) {
    /* Processing variable npix_mat */
    npix_mat_Dims[0]=npix_map,npix_mat_Dims[1]=nu_dim,npix_mat_Dims[2]=nu_dim;
    capi_npix_mat_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_npix_mat_tmp = array_from_pyobj(NPY_DOUBLE,npix_mat_Dims,npix_mat_Rank,capi_npix_mat_intent,Py_None);
    if (capi_npix_mat_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : covarifast_error,"failed in converting hidden `npix_mat' of covarifast.spmat2npmat to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        npix_mat = (double *)(PyArray_DATA(capi_npix_mat_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(s2npix_map,spix_mat,npix_mat,&npix_sup,&npix_map,&nu_dim);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_npix_mat_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /*if (capi_npix_mat_tmp == NULL) ... else of npix_mat*/
    /* End of cleaning variable npix_mat */
    } /*CHECKSCALAR(shape(s2npix_map, 0) == npix_map)*/
    } /*if (f2py_success) of npix_map*/
    /* End of cleaning variable npix_map */
    } /*CHECKSCALAR(shape(spix_mat, 1) == nu_dim)*/
    } /*if (f2py_success) of nu_dim*/
    /* End of cleaning variable nu_dim */
    } /*CHECKSCALAR(shape(spix_mat, 0) == npix_sup)*/
    } /*if (f2py_success) of npix_sup*/
    /* End of cleaning variable npix_sup */
    if((PyObject *)capi_spix_mat_tmp!=spix_mat_capi) {
        Py_XDECREF(capi_spix_mat_tmp); }
    }  /*if (capi_spix_mat_tmp == NULL) ... else of spix_mat*/
    /* End of cleaning variable spix_mat */
    if((PyObject *)capi_s2npix_map_tmp!=s2npix_map_capi) {
        Py_XDECREF(capi_s2npix_map_tmp); }
    }  /*if (capi_s2npix_map_tmp == NULL) ... else of s2npix_map*/
    /* End of cleaning variable s2npix_map */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/***************************** end of spmat2npmat *****************************/

/****************************** compute_cov_mat ******************************/
static char doc_f2py_rout_covarifast_compute_cov_mat[] = "\
cov_map = compute_cov_mat(spix_groups,s2npix_map,wavelet_maps,[npix_sup,npix_map,nu_dim,ngrp])\n\nWrapper for ``compute_cov_mat``.\
\n\nParameters\n----------\n"
"spix_groups : input rank-2 array('i') with bounds (npix_sup,ngrp)\n"
"s2npix_map : input rank-1 array('i') with bounds (npix_map)\n"
"wavelet_maps : input rank-2 array('d') with bounds (nu_dim,npix_map)\n"
"\nOther Parameters\n----------------\n"
"npix_sup : input int, optional\n    Default: shape(spix_groups, 0)\n"
"npix_map : input long, optional\n    Default: shape(s2npix_map, 0)\n"
"nu_dim : input int, optional\n    Default: shape(wavelet_maps, 0)\n"
"ngrp : input int, optional\n    Default: shape(spix_groups, 1)\n"
"\nReturns\n-------\n"
"cov_map : rank-3 array('d') with bounds (npix_sup,nu_dim,nu_dim)";
/* extern void F_FUNC_US(compute_cov_mat,COMPUTE_COV_MAT)(int*,long_long*,int*,int*,int*,int*,double*,double*); */
static PyObject *f2py_rout_covarifast_compute_cov_mat(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,long_long*,int*,int*,int*,int*,double*,double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int npix_sup = 0;
    PyObject *npix_sup_capi = Py_None;
    long_long npix_map = 0;
    PyObject *npix_map_capi = Py_None;
    int nu_dim = 0;
    PyObject *nu_dim_capi = Py_None;
    int ngrp = 0;
    PyObject *ngrp_capi = Py_None;
    int *spix_groups = NULL;
    npy_intp spix_groups_Dims[2] = {-1, -1};
    const int spix_groups_Rank = 2;
    PyArrayObject *capi_spix_groups_tmp = NULL;
    int capi_spix_groups_intent = 0;
    PyObject *spix_groups_capi = Py_None;
    int *s2npix_map = NULL;
    npy_intp s2npix_map_Dims[1] = {-1};
    const int s2npix_map_Rank = 1;
    PyArrayObject *capi_s2npix_map_tmp = NULL;
    int capi_s2npix_map_intent = 0;
    PyObject *s2npix_map_capi = Py_None;
    double *wavelet_maps = NULL;
    npy_intp wavelet_maps_Dims[2] = {-1, -1};
    const int wavelet_maps_Rank = 2;
    PyArrayObject *capi_wavelet_maps_tmp = NULL;
    int capi_wavelet_maps_intent = 0;
    PyObject *wavelet_maps_capi = Py_None;
    double *cov_map = NULL;
    npy_intp cov_map_Dims[3] = {-1, -1, -1};
    const int cov_map_Rank = 3;
    PyArrayObject *capi_cov_map_tmp = NULL;
    int capi_cov_map_intent = 0;
    static char *capi_kwlist[] = {"spix_groups","s2npix_map","wavelet_maps","npix_sup","npix_map","nu_dim","ngrp",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOO|OOOO:covarifast.compute_cov_mat",\
        capi_kwlist,&spix_groups_capi,&s2npix_map_capi,&wavelet_maps_capi,&npix_sup_capi,&npix_map_capi,&nu_dim_capi,&ngrp_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable spix_groups */
    ;
    capi_spix_groups_intent |= F2PY_INTENT_IN;
    capi_spix_groups_tmp = array_from_pyobj(NPY_INT,spix_groups_Dims,spix_groups_Rank,capi_spix_groups_intent,spix_groups_capi);
    if (capi_spix_groups_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : covarifast_error,"failed in converting 1st argument `spix_groups' of covarifast.compute_cov_mat to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        spix_groups = (int *)(PyArray_DATA(capi_spix_groups_tmp));

    /* Processing variable s2npix_map */
    ;
    capi_s2npix_map_intent |= F2PY_INTENT_IN;
    capi_s2npix_map_tmp = array_from_pyobj(NPY_INT,s2npix_map_Dims,s2npix_map_Rank,capi_s2npix_map_intent,s2npix_map_capi);
    if (capi_s2npix_map_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : covarifast_error,"failed in converting 2nd argument `s2npix_map' of covarifast.compute_cov_mat to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        s2npix_map = (int *)(PyArray_DATA(capi_s2npix_map_tmp));

    /* Processing variable npix_sup */
    if (npix_sup_capi == Py_None) npix_sup = shape(spix_groups, 0); else
        f2py_success = int_from_pyobj(&npix_sup,npix_sup_capi,"covarifast.compute_cov_mat() 1st keyword (npix_sup) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(spix_groups, 0) == npix_sup,"shape(spix_groups, 0) == npix_sup","1st keyword npix_sup","compute_cov_mat:npix_sup=%d",npix_sup) {
    /* Processing variable ngrp */
    if (ngrp_capi == Py_None) ngrp = shape(spix_groups, 1); else
        f2py_success = int_from_pyobj(&ngrp,ngrp_capi,"covarifast.compute_cov_mat() 4th keyword (ngrp) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(spix_groups, 1) == ngrp,"shape(spix_groups, 1) == ngrp","4th keyword ngrp","compute_cov_mat:ngrp=%d",ngrp) {
    /* Processing variable npix_map */
    if (npix_map_capi == Py_None) npix_map = shape(s2npix_map, 0); else
        f2py_success = long_long_from_pyobj(&npix_map,npix_map_capi,"covarifast.compute_cov_mat() 2nd keyword (npix_map) can't be converted to long_long");
    if (f2py_success) {
    CHECKSCALAR(shape(s2npix_map, 0) == npix_map,"shape(s2npix_map, 0) == npix_map","2nd keyword npix_map","compute_cov_mat:npix_map=%ld",npix_map) {
    /* Processing variable wavelet_maps */
    wavelet_maps_Dims[1]=npix_map;
    capi_wavelet_maps_intent |= F2PY_INTENT_IN;
    capi_wavelet_maps_tmp = array_from_pyobj(NPY_DOUBLE,wavelet_maps_Dims,wavelet_maps_Rank,capi_wavelet_maps_intent,wavelet_maps_capi);
    if (capi_wavelet_maps_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : covarifast_error,"failed in converting 3rd argument `wavelet_maps' of covarifast.compute_cov_mat to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        wavelet_maps = (double *)(PyArray_DATA(capi_wavelet_maps_tmp));

    /* Processing variable nu_dim */
    if (nu_dim_capi == Py_None) nu_dim = shape(wavelet_maps, 0); else
        f2py_success = int_from_pyobj(&nu_dim,nu_dim_capi,"covarifast.compute_cov_mat() 3rd keyword (nu_dim) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(wavelet_maps, 0) == nu_dim,"shape(wavelet_maps, 0) == nu_dim","3rd keyword nu_dim","compute_cov_mat:nu_dim=%d",nu_dim) {
    /* Processing variable cov_map */
    cov_map_Dims[0]=npix_sup,cov_map_Dims[1]=nu_dim,cov_map_Dims[2]=nu_dim;
    capi_cov_map_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_cov_map_tmp = array_from_pyobj(NPY_DOUBLE,cov_map_Dims,cov_map_Rank,capi_cov_map_intent,Py_None);
    if (capi_cov_map_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : covarifast_error,"failed in converting hidden `cov_map' of covarifast.compute_cov_mat to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        cov_map = (double *)(PyArray_DATA(capi_cov_map_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(&npix_sup,&npix_map,&nu_dim,&ngrp,spix_groups,s2npix_map,wavelet_maps,cov_map);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_cov_map_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /*if (capi_cov_map_tmp == NULL) ... else of cov_map*/
    /* End of cleaning variable cov_map */
    } /*CHECKSCALAR(shape(wavelet_maps, 0) == nu_dim)*/
    } /*if (f2py_success) of nu_dim*/
    /* End of cleaning variable nu_dim */
    if((PyObject *)capi_wavelet_maps_tmp!=wavelet_maps_capi) {
        Py_XDECREF(capi_wavelet_maps_tmp); }
    }  /*if (capi_wavelet_maps_tmp == NULL) ... else of wavelet_maps*/
    /* End of cleaning variable wavelet_maps */
    } /*CHECKSCALAR(shape(s2npix_map, 0) == npix_map)*/
    } /*if (f2py_success) of npix_map*/
    /* End of cleaning variable npix_map */
    } /*CHECKSCALAR(shape(spix_groups, 1) == ngrp)*/
    } /*if (f2py_success) of ngrp*/
    /* End of cleaning variable ngrp */
    } /*CHECKSCALAR(shape(spix_groups, 0) == npix_sup)*/
    } /*if (f2py_success) of npix_sup*/
    /* End of cleaning variable npix_sup */
    if((PyObject *)capi_s2npix_map_tmp!=s2npix_map_capi) {
        Py_XDECREF(capi_s2npix_map_tmp); }
    }  /*if (capi_s2npix_map_tmp == NULL) ... else of s2npix_map*/
    /* End of cleaning variable s2npix_map */
    if((PyObject *)capi_spix_groups_tmp!=spix_groups_capi) {
        Py_XDECREF(capi_spix_groups_tmp); }
    }  /*if (capi_spix_groups_tmp == NULL) ... else of spix_groups*/
    /* End of cleaning variable spix_groups */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/*************************** end of compute_cov_mat ***************************/
/*eof body*/

/******************* See f2py2e/f90mod_rules.py: buildhooks *******************/
/*need_f90modhooks*/

/************** See f2py2e/rules.py: module_rules['modulebody'] **************/

/******************* See f2py2e/common_rules.py: buildhooks *******************/

/*need_commonhooks*/

/**************************** See f2py2e/rules.py ****************************/

static FortranDataDef f2py_routine_defs[] = {
    {"nbr2idx",-1,{{-1}},0,(char *)F_FUNC(nbr2idx,NBR2IDX),(f2py_init_func)f2py_rout_covarifast_nbr2idx,doc_f2py_rout_covarifast_nbr2idx},
    {"spix2idx",-1,{{-1}},0,(char *)F_FUNC(spix2idx,SPIX2IDX),(f2py_init_func)f2py_rout_covarifast_spix2idx,doc_f2py_rout_covarifast_spix2idx},
    {"fast_cov",-1,{{-1}},0,(char *)F_FUNC_US(fast_cov,FAST_COV),(f2py_init_func)f2py_rout_covarifast_fast_cov,doc_f2py_rout_covarifast_fast_cov},
    {"spmat2npmat",-1,{{-1}},0,(char *)F_FUNC(spmat2npmat,SPMAT2NPMAT),(f2py_init_func)f2py_rout_covarifast_spmat2npmat,doc_f2py_rout_covarifast_spmat2npmat},
    {"compute_cov_mat",-1,{{-1}},0,(char *)F_FUNC_US(compute_cov_mat,COMPUTE_COV_MAT),(f2py_init_func)f2py_rout_covarifast_compute_cov_mat,doc_f2py_rout_covarifast_compute_cov_mat},

/*eof routine_defs*/
    {NULL}
};

static PyMethodDef f2py_module_methods[] = {

    {NULL,NULL}
};

static struct PyModuleDef moduledef = {
    PyModuleDef_HEAD_INIT,
    "covarifast",
    NULL,
    -1,
    f2py_module_methods,
    NULL,
    NULL,
    NULL,
    NULL
};

PyMODINIT_FUNC PyInit_covarifast(void) {
    int i;
    PyObject *m,*d, *s, *tmp;
    m = covarifast_module = PyModule_Create(&moduledef);
    Py_SET_TYPE(&PyFortran_Type, &PyType_Type);
    import_array();
    if (PyErr_Occurred())
        {PyErr_SetString(PyExc_ImportError, "can't initialize module covarifast (failed to import numpy)"); return m;}
    d = PyModule_GetDict(m);
    s = PyUnicode_FromString("1.22.4");
    PyDict_SetItemString(d, "__version__", s);
    Py_DECREF(s);
    s = PyUnicode_FromString(
        "This module 'covarifast' is auto-generated with f2py (version:1.22.4).\nFunctions:\n"
"    idx_map_1 = nbr2idx(n2spix_map_1,nbr_grp_1,npix_1=shape(n2spix_map_1, 0),ngrp_1=shape(nbr_grp_1, 0))\n"
"    idx_map_2 = spix2idx(n2spix_map_2,spix_2,npix_2=shape(n2spix_map_2, 0))\n"
"    cov = fast_cov(map_1,map_2,mask,npix_3=shape(map_1, 0))\n"
"    npix_mat = spmat2npmat(s2npix_map,spix_mat,npix_sup=shape(spix_mat, 0),npix_map=shape(s2npix_map, 0),nu_dim=shape(spix_mat, 1))\n"
"    cov_map = compute_cov_mat(spix_groups,s2npix_map,wavelet_maps,npix_sup=shape(spix_groups, 0),npix_map=shape(s2npix_map, 0),nu_dim=shape(wavelet_maps, 0),ngrp=shape(spix_groups, 1))\n"
".");
    PyDict_SetItemString(d, "__doc__", s);
    Py_DECREF(s);
    s = PyUnicode_FromString("1.22.4");
    PyDict_SetItemString(d, "__f2py_numpy_version__", s);
    Py_DECREF(s);
    covarifast_error = PyErr_NewException ("covarifast.error", NULL, NULL);
    /*
     * Store the error object inside the dict, so that it could get deallocated.
     * (in practice, this is a module, so it likely will not and cannot.)
     */
    PyDict_SetItemString(d, "_covarifast_error", covarifast_error);
    Py_DECREF(covarifast_error);
    for(i=0;f2py_routine_defs[i].name!=NULL;i++) {
        tmp = PyFortranObject_NewAsAttr(&f2py_routine_defs[i]);
        PyDict_SetItemString(d, f2py_routine_defs[i].name, tmp);
        Py_DECREF(tmp);
    }





/*eof initf2pywraphooks*/
/*eof initf90modhooks*/

/*eof initcommonhooks*/


#ifdef F2PY_REPORT_ATEXIT
    if (! PyErr_Occurred())
        on_exit(f2py_report_on_exit,(void*)"covarifast");
#endif
    return m;
}
#ifdef __cplusplus
}
#endif
